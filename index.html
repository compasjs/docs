
<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0"/>
        <title>Compas</title>
        <meta name="description" content="Unified backend tooling"/>
        <link rel="canonical" href="https://compasjs.com/index.html"/>
        <style>
            body {margin: 5% auto; background: #f2f2f2; color: #444444; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; font-size: 16px; line-height: 1.8; text-shadow: 0 1px 0 #ffffff; max-width: 73%;}
            pre, code {background: white;}
            pre {padding-left: 2px; line-height: 1.2; }
            code {margin-left: 2px; margin-right: 2px; }
            a {border-bottom: 1px solid #444444; color: #444444; text-decoration: none;}
            a:hover {border-bottom: 0;}
            .hljs{display:block;overflow-x:auto;padding:.5em;background:#f0f0f0}.hljs,.hljs-subst{color:#444}.hljs-comment{color:#888}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-meta-keyword,.hljs-name,.hljs-selector-tag{font-weight:700}.hljs-deletion,.hljs-number,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#800}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-link,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#bc6060}.hljs-literal{color:#78a960}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code{color:#397300}.hljs-meta{color:#1f7199}.hljs-meta-string{color:#4d99bf}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}
        </style>
    </head>
    <body>
    <header>
        <nav></nav>
    </header>
    <main>
    <article>
        <h1 id="compas">Compas</h1>
<p>Unified backend tooling</p>
<hr>
<h2 id="features">Features</h2>
<ul>
<li>Script and test runner with built-in watcher</li>
<li>Flexible code generators supporting routers, validators, api clients and
Postgres queries</li>
<li>Structured logger</li>
<li>Common utilities like session handling, job queue, file storage and loading
&#39;.env&#39; files</li>
</ul>
<h2 id="requirements">Requirements</h2>
<ul>
<li>Node.js &gt;= 14</li>
<li>Yarn 1.x.x</li>
</ul>
<h2 id="sneak-peak">Sneak peak</h2>
<p>A small peak in how what the code generators can help you with:</p>
<h3 id="validators">Validators</h3>
<p>A quick showcase of the TypeCreator and how the resulting functions can be used</p>
<pre><code class="language-js"><span class="hljs-keyword">import</span> { App, TypeCreator } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@compas/code-gen&quot;</span>;

<span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> App();

app.add(
  T.object(<span class="hljs-string">&quot;user&quot;</span>).keys({
    <span class="hljs-attr">name</span>: T.string().min(<span class="hljs-number">3</span>),
    <span class="hljs-attr">height</span>: T.number()
      .float()
      .max(<span class="hljs-number">2.2</span>)
      .docs(<span class="hljs-string">&quot;Height in meters, we don&#x27;t support giants&quot;</span>),
    <span class="hljs-attr">wantsSpamEmail</span>: T.bool().default(<span class="hljs-literal">false</span>),
  }),
);

app.generate({
  <span class="hljs-attr">outputDirectory</span>: <span class="hljs-string">&quot;./generated/validators&quot;</span>,
  <span class="hljs-attr">enabledGenerators</span>: [<span class="hljs-string">&quot;type&quot;</span>, <span class="hljs-string">&quot;validator&quot;</span>],
});
</code></pre>
<p>And some examples of how to use the generated code:</p>
<pre><code class="language-js"><span class="hljs-keyword">import</span> { uuid } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@compas/stdlib&quot;</span>;
<span class="hljs-keyword">import</span> { validateAppTodo } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./generated/validators/index.js&quot;</span>;

<span class="hljs-comment">// Throws AppError: validator.string.undefined at $.name</span>
validateAppTodo({});

<span class="hljs-comment">// Throws AppError: validator.string.min at $.name, min: 3</span>
validateAppTodo({
  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Ab&quot;</span>,
});

<span class="hljs-keyword">const</span> user = validateAppTodo({
  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Dirk&quot;</span>,
  <span class="hljs-attr">height</span>: <span class="hljs-number">1.88</span>,
});
<span class="hljs-comment">// user.wantsSpamEmail === false</span>
</code></pre>
<h3 id="router-and-api-clients">Router and api clients</h3>
<p>Showing the api client and react-query based hooks as generated for an api
consumer. Backend structure:</p>
<pre><code class="language-js"><span class="hljs-keyword">import</span> { App, TypeCreator } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@compas/code-gen&quot;</span>;

<span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> App();
<span class="hljs-keyword">const</span> T = <span class="hljs-keyword">new</span> TypeCreator(<span class="hljs-string">&quot;todo&quot;</span>);
<span class="hljs-keyword">const</span> R = T.router(<span class="hljs-string">&quot;/todo&quot;</span>);

<span class="hljs-keyword">const</span> todo = T.object(<span class="hljs-string">&quot;item&quot;</span>).keys({
  <span class="hljs-attr">id</span>: T.uuid(),
  <span class="hljs-attr">value</span>: T.string(),
  <span class="hljs-attr">done</span>: T.bool(),
});

app.add(
  R.get(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-string">&quot;list&quot;</span>).response({
    <span class="hljs-attr">list</span>: [todo],
  }),

  R.get(<span class="hljs-string">&quot;/:todoId&quot;</span>, <span class="hljs-string">&quot;single&quot;</span>)
    .params({
      <span class="hljs-attr">todoId</span>: T.uuid(),
    })
    .response({
      todo,
    }),

  R.post(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-string">&quot;create&quot;</span>)
    .body({
      <span class="hljs-attr">value</span>: T.string(),
    })
    .response({
      todo,
    }),

  R.post(<span class="hljs-string">&quot;/:todoId/complete&quot;</span>, <span class="hljs-string">&quot;markComplete&quot;</span>).response({
    <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
  }),
);

<span class="hljs-comment">// ... app.generate</span>
</code></pre>
<p>Once the frontend is generated, see the <a href="TODO">client-setup</a>, it can be used as
follows:</p>
<pre><code class="language-tsx">function renderTodo({ todoId }: TodoSingleParams) {
  // Generated react-query hook with typed results
  const { data } = useTodoSingle({ todoId });
  // data.id, data.value, data.done

  return &lt;div&gt;{/*...*/}&lt;/div&gt;;
}

function renderTodoList() {
  // Typed api client
  const api = useApi();
  const markTodoComplete = (todoId: string) =&gt;
    api.todo.markComplete({ todoId });

  return &lt;div&gt;{/*...*/}&lt;/div&gt;;
}
</code></pre>
<h2 id="why">Why</h2>
<p>My work involved doing many small projects. I had a hard time backporting
incremental fixes to existing projects. To facilitate my needs more and to stop
copying and pasting things around, this project was born.</p>
<h2 id="docs-and-development">Docs and development</h2>
<p>See <a href="https://compasjs.com">the website</a> for the changelog, all available APIs
and various guides.</p>
<p>For contributing see <a href="https://compasjs.com/contributing">contributing.md</a>.</p>
<h2 id="new-features">New features</h2>
<p>New features added should fall under the following categories:</p>
<ul>
<li>It improves the interface between api and client in some way. An example may
be to support websockets in @compas/code-gen</li>
<li>It improves the developer experience one way or another while developing an
api For example the <code>compas docker</code> commands or various utilities provided by
@compas/stdlib</li>
</ul>
<p>Although some parts heavily rely on conventions set by the packages, we
currently aim not to be a framework. We aim to provide a good developer
experience, useful abstractions around the basics, and a stable backend &lt;-&gt;
client interface.</p>

    </article>
    <article><ul><li><a href="https://compasjs.com/setup/index.html">Project setup</a></li><li><a href="https://compasjs.com/features/index.html">Features</a></li><li><a href="https://compasjs.com/changelog.html">Changelog</a></li><li><a href="https://compasjs.com/releases/index.html">Releases</a></li><li><a href="https://compasjs.com/contributing.html">Contributing</a></li><li><a href="https://compasjs.com/raw/index.html">Old docs</a></li></ul></article>
    </main>
    <footer>
        <nav></nav>
    </footer>
    </body>
</html>
  