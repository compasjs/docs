
<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0"/>
        <title>Release v0.0.138</title>
        <meta name="description" content="Release notes for Compas v0.0.138"/>
        <link rel="canonical" href="https://compasjs.com/releases/0.0.138.html"/>
        <style>
            body {margin: 5% auto; background: #f2f2f2; color: #444444; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; font-size: 16px; line-height: 1.8; text-shadow: 0 1px 0 #ffffff; max-width: 73%;}
            pre, code {background: white;}
            pre {padding-left: 2px; line-height: 1.2; }
            code {margin-left: 2px; margin-right: 2px; }
            a {border-bottom: 1px solid #444444; color: #444444; text-decoration: none;}
            a:hover {border-bottom: 0;}
            a.anchor { float: right; text-decoration: none; padding: 1px 3px; border-bottom: none; }
            .hljs{display:block;overflow-x:auto;padding:.5em;background:#f0f0f0}.hljs,.hljs-subst{color:#444}.hljs-comment{color:#888}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-meta-keyword,.hljs-name,.hljs-selector-tag{font-weight:700}.hljs-deletion,.hljs-number,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#800}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-link,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#bc6060}.hljs-literal{color:#78a960}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code{color:#397300}.hljs-meta{color:#1f7199}.hljs-meta-string{color:#4d99bf}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}
        </style>
    </head>
    <body>
    <header>
        <nav><a href="https://compasjs.com/index.html">Compas</a> > <a href="https://compasjs.com/releases/index.html">Releases</a></nav>
    </header>
    <main>
    <article>
        <h1 id="release-notes-v00138">
  Release notes v0.0.138
  
</h1>
<p>We had 14 releases without release notes, so there must be big breaking changes.</p>
<h2 id="code-gen">
  Code gen
  <a name="code-gen" class="anchor" href="#code-gen">#</a>
</h2>
<p>The code generator got a few small improvements</p>
<ul>
<li>router: nicely catch invalid encoded path params and throw a 400 error</li>
<li>sql: improve performance of oneToMany queryBuilder calls by 10 to 15 percent</li>
<li>validator: add mimeTypes support to <code>T.file()</code>, this allows for setting things
like: <code>T.file().mimeTypes(&quot;image/jpg&quot;, &quot;image/png&quot;)</code>. This is only validated
on the server after parsing posted body.</li>
</ul>
<h2 id="migrations">
  Migrations
  <a name="migrations" class="anchor" href="#migrations">#</a>
</h2>
<p>The previous migration system with namespaces support had various issues when
namespaces where dropped or added. The production environments would work fine,
since the migration system allows for missing migrations files, but when
resetting the development database, migration files were missing when a package
was removed. This causes migration files to become invalid. When a package is
added, you would like the migrations of the package to follow in time with the
application migrations, but that&#39;s complex to pull off.</p>
<p>To ease all this we decided to drop namespaces support and instead enforce you
to &#39;vendor&#39; migrations from packages. This is a big braking change, but here are
the steps:</p>
<ul>
<li>Vendor the @compas/store migrations per
<a href="https://compasjs.com/features/migrations.html#built-in-migration-requirements">the migration docs</a></li>
<li>Vender migrations of the packages you use following their docs</li>
<li>Update the migrate commands to <code>yarn compas docker migrate</code></li>
<li>Stop the migration service and do a deploy</li>
<li>Manually do a <code>yarn compas docker migrate rebuild</code></li>
<li>Start the migration service back up.</li>
</ul>
<h2 id="in-closing">
  In closing
  <a name="in-closing" class="anchor" href="#in-closing">#</a>
</h2>
<p>We are somehow getting to a pretty stable point. The docs however, are quite
lacking. Between this and the previous release I added docs about environment
variables and migrations. It&#39;s a slow and tedious process. Please submit doc
request issues as well in the Compas
<a href="https://github.com/compasjs/compas/issues">issue tracker</a>.</p>

    </article>
    
    </main>
    <footer>
        <nav><a href="https://compasjs.com/index.html">Compas</a> > <a href="https://compasjs.com/releases/index.html">Releases</a></nav>
    </footer>
    </body>
</html>
  