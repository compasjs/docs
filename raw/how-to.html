
<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0"/>
        <title>How to</title>
        <meta name="description" content="Compas old docs"/>
        <link rel="canonical" href="https://pre.compasjs.com/raw/how-to.html"/>
        <style>
            body {margin: 5% auto; background: #f2f2f2; color: #444444; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; font-size: 16px; line-height: 1.8; text-shadow: 0 1px 0 #ffffff; max-width: 73%;}
            pre, code {background: white;}
            pre {padding-left: 2px; line-height: 1.2; }
            code {margin-left: 2px; margin-right: 2px; }
            a {border-bottom: 1px solid #444444; color: #444444; text-decoration: none;}
            a:hover {border-bottom: 0;}
            .hljs{display:block;overflow-x:auto;padding:.5em;background:#f0f0f0}.hljs,.hljs-subst{color:#444}.hljs-comment{color:#888}.hljs-attribute,.hljs-doctag,.hljs-keyword,.hljs-meta-keyword,.hljs-name,.hljs-selector-tag{font-weight:700}.hljs-deletion,.hljs-number,.hljs-quote,.hljs-selector-class,.hljs-selector-id,.hljs-string,.hljs-template-tag,.hljs-type{color:#800}.hljs-section,.hljs-title{color:#800;font-weight:700}.hljs-link,.hljs-regexp,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-symbol,.hljs-template-variable,.hljs-variable{color:#bc6060}.hljs-literal{color:#78a960}.hljs-addition,.hljs-built_in,.hljs-bullet,.hljs-code{color:#397300}.hljs-meta{color:#1f7199}.hljs-meta-string{color:#4d99bf}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}
        </style>
    </head>
    <body>
    <header>
        <nav><a href="https://pre.compasjs.com/index.html">Compas</a> > <a href="https://pre.compasjs.com/raw/index.html">Old docs</a></nav>
    </header>
    <main>
    <article>
        <h1 id="how-to">How to</h1>
<p>A number of examples of how to utilise the functionalities provided by <code>@lbu/*</code>.
The How To&#39;s mention default arguments, ready to run examples and some possible
edge cases.</p>
<h2 id="asserting-on-throws">Asserting on throws</h2>
<p>Asserting on throws is another overlooked part of some test runners. This test
runner does not provide any fancy util like <code>t.throws(functionThatThrows)</code>, but
expects the user to use normal control flow like try / catch.</p>
<!-- howto-test-pass-fail -->

<pre><code class="language-js"><span class="hljs-keyword">const</span> throws = <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&quot;Oops!&quot;</span>);
};

<span class="hljs-keyword">const</span> doesNotThrow = <span class="hljs-function">() =&gt;</span> {};

test(<span class="hljs-string">&quot;Throws vs not throws&quot;</span>, <span class="hljs-keyword">async</span> (t) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> throws();
    t.fail(<span class="hljs-string">`The &#x27;throws&#x27; function should have thrown.`</span>);
  } <span class="hljs-keyword">catch</span> (e) {
    t.equal(e.message, <span class="hljs-string">&quot;Oops!&quot;</span>);
  }

  <span class="hljs-keyword">try</span> {
    doesNotThrow();
    t.pass(<span class="hljs-string">&quot;The function did not throw!&quot;</span>);
  } <span class="hljs-keyword">catch</span> (e) {
    t.fail(<span class="hljs-string">`The &#x27;doesNotThrow&#x27; function did throw.`</span>);

    <span class="hljs-comment">// A logger from @lbu/insight is available</span>
    t.log.error(e);
  }
});</code></pre>
<h2 id="execute-process">Execute Process</h2>
<p>There are two ways to execute a program or <code>child_process</code> provided by
<code>@lbu/stdlib</code>:</p>
<ul>
<li>Exec, a promisified version of
<a href="https://nodejs.org/api/child_process.html#child_process_child_process_exec_command_options_callback"><code>child_process#exec</code></a></li>
</ul>
<!-- howto-exec -->

<pre><code class="language-js"><span class="hljs-keyword">const</span> { stdout, stderr, exitCode } = <span class="hljs-keyword">await</span> exec(<span class="hljs-string">&quot;echo &#x27;foo&#x27;&quot;</span>);
<span class="hljs-comment">// stdout =&gt; &quot;foo\n&quot;</span>
<span class="hljs-comment">// stderr =&gt; &quot;&quot;</span>
<span class="hljs-comment">// exitCode =&gt; 0</span></code></pre>
<!-- howto-exec -->

<ul>
<li>Spawn, a promisified version of
<a href="https://nodejs.org/api/child_process.html#child_process_child_process_spawn_command_args_options"><code>child_process#spawn</code></a></li>
</ul>
<!-- howto-spawn -->

<pre><code class="language-js"><span class="hljs-keyword">const</span> { exitCode } = <span class="hljs-keyword">await</span> spawn(<span class="hljs-string">&quot;echo&quot;</span>, [<span class="hljs-string">&quot;bar&quot;</span>]);
<span class="hljs-comment">// Outputs &quot;bar\n&quot; on stdout</span>
<span class="hljs-comment">// exitCode =&gt; 0</span></code></pre>
<!-- howto-spawn -->

<p>By default <code>{ stdio: &quot;inherit&quot; }</code> is passed to <code>spawn</code> which means that all of
stdin, stdout and stderr are passed to the spawned process.</p>
<p>Use <code>exec</code> when further processing of stdout and stdin is needed or when you
want to ignore any output. Use <code>spawn</code> in other cases.</p>

    </article>
    
    </main>
    <footer>
        <nav><a href="https://pre.compasjs.com/index.html">Compas</a> > <a href="https://pre.compasjs.com/raw/index.html">Old docs</a></nav>
    </footer>
    </body>
</html>
  